"use strict";var bigInt=function(t){var e=1e7,n=7,r=9007199254740992,o=c(r),i=Math.log(r);function a(t,e){return void 0===t?a[0]:void 0!==e?10==+e?$(t):R(t,e):$(t)}function s(t,e){this.value=t,this.sign=e,this.isSmall=!1}function l(t){this.value=t,this.sign=t<0,this.isSmall=!0}function u(t){return-r<t&&t<r}function c(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function p(t){h(t);var n=t.length;if(n<4&&M(t,o)<0)switch(n){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function h(t){for(var e=t.length;0===t[--e];);t.length=e+1}function d(t){for(var e=new Array(t),n=-1;++n<t;)e[n]=0;return e}function f(t){return t>0?Math.floor(t):Math.ceil(t)}function v(t,n){var r,o,i=t.length,a=n.length,s=new Array(i),l=0,u=e;for(o=0;o<a;o++)l=(r=t[o]+n[o]+l)>=u?1:0,s[o]=r-l*u;for(;o<i;)l=(r=t[o]+l)===u?1:0,s[o++]=r-l*u;return l>0&&s.push(l),s}function g(t,e){return t.length>=e.length?v(t,e):v(e,t)}function m(t,n){var r,o,i=t.length,a=new Array(i),s=e;for(o=0;o<i;o++)r=t[o]-s+n,n=Math.floor(r/s),a[o]=r-n*s,n+=1;for(;n>0;)a[o++]=n%s,n=Math.floor(n/s);return a}function y(t,n){var r,o,i=t.length,a=n.length,s=new Array(i),l=0,u=e;for(r=0;r<a;r++)(o=t[r]-l-n[r])<0?(o+=u,l=1):l=0,s[r]=o;for(r=a;r<i;r++){if(!((o=t[r]-l)<0)){s[r++]=o;break}o+=u,s[r]=o}for(;r<i;r++)s[r]=t[r];return h(s),s}function b(t,n,r){var o,i,a=t.length,u=new Array(a),c=-n,h=e;for(o=0;o<a;o++)i=t[o]+c,c=Math.floor(i/h),i%=h,u[o]=i<0?i+h:i;return"number"==typeof(u=p(u))?(r&&(u=-u),new l(u)):new s(u,r)}function w(t,n){var r,o,i,a,s=t.length,l=n.length,u=d(s+l),c=e;for(i=0;i<s;++i){a=t[i];for(var p=0;p<l;++p)r=a*n[p]+u[i+p],o=Math.floor(r/c),u[i+p]=r-o*c,u[i+p+1]+=o}return h(u),u}function x(t,n){var r,o,i=t.length,a=new Array(i),s=e,l=0;for(o=0;o<i;o++)r=t[o]*n+l,l=Math.floor(r/s),a[o]=r-l*s;for(;l>0;)a[o++]=l%s,l=Math.floor(l/s);return a}function S(t,e){for(var n=[];e-- >0;)n.push(0);return n.concat(t)}function _(t,n,r){return new s(t<e?x(n,t):w(n,c(t)),r)}function q(t){var n,r,o,i,a=t.length,s=d(a+a),l=e;for(o=0;o<a;o++){i=t[o];for(var u=0;u<a;u++)n=i*t[u]+s[o+u],r=Math.floor(n/l),s[o+u]=n-r*l,s[o+u+1]+=r}return h(s),s}function E(t,n){var r,o,i,a,s=t.length,l=d(s),u=e;for(i=0,r=s-1;r>=0;--r)i=(a=i*u+t[r])-(o=f(a/n))*n,l[r]=0|o;return[l,0|i]}function T(t,n){var r,o,i=$(n),u=t.value,v=i.value;if(0===v)throw new Error("Cannot divide by zero");if(t.isSmall)return i.isSmall?[new l(f(u/v)),new l(u%v)]:[a[0],t];if(i.isSmall){if(1===v)return[t,a[0]];if(-1==v)return[t.negate(),a[0]];var g=Math.abs(v);if(g<e){o=p((r=E(u,g))[0]);var m=r[1];return t.sign&&(m=-m),"number"==typeof o?(t.sign!==i.sign&&(o=-o),[new l(o),new l(m)]):[new s(o,t.sign!==i.sign),new l(m)]}v=c(g)}var b=M(u,v);if(-1===b)return[a[0],t];if(0===b)return[a[t.sign===i.sign?1:-1],a[0]];o=(r=u.length+v.length<=200?function(t,n){var r,o,i,a,s,l,u,c=t.length,h=n.length,f=e,v=d(n.length),g=n[h-1],m=Math.ceil(f/(2*g)),y=x(t,m),b=x(n,m);for(y.length<=c&&y.push(0),b.push(0),g=b[h-1],o=c-h;o>=0;o--){for(r=f-1,y[o+h]!==g&&(r=Math.floor((y[o+h]*f+y[o+h-1])/g)),i=0,a=0,l=b.length,s=0;s<l;s++)i+=r*b[s],u=Math.floor(i/f),a+=y[o+s]-(i-u*f),i=u,a<0?(y[o+s]=a+f,a=-1):(y[o+s]=a,a=0);for(;0!==a;){for(r-=1,i=0,s=0;s<l;s++)(i+=y[o+s]-f+b[s])<0?(y[o+s]=i+f,i=0):(y[o+s]=i,i=1);a+=i}v[o]=r}return y=E(y,m)[0],[p(v),p(y)]}(u,v):function(t,n){for(var r,o,i,a,s,l=t.length,u=n.length,c=[],d=[],f=e;l;)if(d.unshift(t[--l]),h(d),M(d,n)<0)c.push(0);else{i=d[(o=d.length)-1]*f+d[o-2],a=n[u-1]*f+n[u-2],o>u&&(i=(i+1)*f),r=Math.ceil(i/a);do{if(M(s=x(n,r),d)<=0)break;r--}while(r);c.push(r),d=y(d,s)}return c.reverse(),[p(c),p(d)]}(u,v))[0];var w=t.sign!==i.sign,S=r[1],_=t.sign;return"number"==typeof o?(w&&(o=-o),o=new l(o)):o=new s(o,w),"number"==typeof S?(_&&(S=-S),S=new l(S)):S=new s(S,_),[o,S]}function M(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n])return t[n]>e[n]?1:-1;return 0}function L(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(25)||void 0))}s.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),s.prototype.add=function(t){var e=$(t);if(this.sign!==e.sign)return this.subtract(e.negate());var n=this.value,r=e.value;return e.isSmall?new s(m(n,Math.abs(r)),this.sign):new s(g(n,r),this.sign)},s.prototype.plus=s.prototype.add,l.prototype.add=function(t){var e=$(t),n=this.value;if(n<0!==e.sign)return this.subtract(e.negate());var r=e.value;if(e.isSmall){if(u(n+r))return new l(n+r);r=c(Math.abs(r))}return new s(m(r,Math.abs(n)),n<0)},l.prototype.plus=l.prototype.add,s.prototype.subtract=function(t){var e=$(t);if(this.sign!==e.sign)return this.add(e.negate());var n=this.value,r=e.value;return e.isSmall?b(n,Math.abs(r),this.sign):function(t,e,n){var r;return M(t,e)>=0?r=y(t,e):(r=y(e,t),n=!n),"number"==typeof(r=p(r))?(n&&(r=-r),new l(r)):new s(r,n)}(n,r,this.sign)},s.prototype.minus=s.prototype.subtract,l.prototype.subtract=function(t){var e=$(t),n=this.value;if(n<0!==e.sign)return this.add(e.negate());var r=e.value;return e.isSmall?new l(n-r):b(r,Math.abs(n),n>=0)},l.prototype.minus=l.prototype.subtract,s.prototype.negate=function(){return new s(this.value,!this.sign)},l.prototype.negate=function(){var t=this.sign,e=new l(-this.value);return e.sign=!t,e},s.prototype.abs=function(){return new s(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},s.prototype.multiply=function(t){var n,r,o,i=$(t),l=this.value,u=i.value,p=this.sign!==i.sign;if(i.isSmall){if(0===u)return a[0];if(1===u)return this;if(-1===u)return this.negate();if((n=Math.abs(u))<e)return new s(x(l,n),p);u=c(n)}return r=l.length,o=u.length,new s(-.012*r-.012*o+15e-6*r*o>0?function t(e,n){var r=Math.max(e.length,n.length);if(r<=30)return w(e,n);r=Math.ceil(r/2);var o=e.slice(r),i=e.slice(0,r),a=n.slice(r),s=n.slice(0,r),l=t(i,s),u=t(o,a),c=t(g(i,o),g(s,a)),p=g(g(l,S(y(y(c,l),u),r)),S(u,2*r));return h(p),p}(l,u):w(l,u),p)},s.prototype.times=s.prototype.multiply,l.prototype._multiplyBySmall=function(t){return u(t.value*this.value)?new l(t.value*this.value):_(Math.abs(t.value),c(Math.abs(this.value)),this.sign!==t.sign)},s.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():_(Math.abs(t.value),this.value,this.sign!==t.sign)},l.prototype.multiply=function(t){return $(t)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,s.prototype.square=function(){return new s(q(this.value),!1)},l.prototype.square=function(){var t=this.value*this.value;return u(t)?new l(t):new s(q(c(Math.abs(this.value))),!1)},s.prototype.divmod=function(t){var e=T(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=s.prototype.divmod,s.prototype.divide=function(t){return T(this,t)[0]},l.prototype.over=l.prototype.divide=s.prototype.over=s.prototype.divide,s.prototype.mod=function(t){return T(this,t)[1]},l.prototype.remainder=l.prototype.mod=s.prototype.remainder=s.prototype.mod,s.prototype.pow=function(t){var e,n,r,o=$(t),i=this.value,s=o.value;if(0===s)return a[1];if(0===i)return a[0];if(1===i)return a[1];if(-1===i)return o.isEven()?a[1]:a[-1];if(o.sign)return a[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&u(e=Math.pow(i,s)))return new l(f(e));for(n=this,r=a[1];!0&s&&(r=r.times(n),--s),0!==s;)s/=2,n=n.square();return r},l.prototype.pow=s.prototype.pow,s.prototype.modPow=function(t,e){if(t=$(t),(e=$(e)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var n=a[1],r=this.mod(e);t.isPositive();){if(r.isZero())return a[0];t.isOdd()&&(n=n.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return n},l.prototype.modPow=s.prototype.modPow,s.prototype.compareAbs=function(t){var e=$(t),n=this.value,r=e.value;return e.isSmall?1:M(n,r)},l.prototype.compareAbs=function(t){var e=$(t),n=Math.abs(this.value),r=e.value;return e.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},s.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=$(t),n=this.value,r=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:M(n,r)*(this.sign?-1:1)},s.prototype.compareTo=s.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=$(t),n=this.value,r=e.value;return e.isSmall?n==r?0:n>r?1:-1:n<0!==e.sign?n<0?-1:1:n<0?1:-1},l.prototype.compareTo=l.prototype.compare,s.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=s.prototype.eq=s.prototype.equals,s.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=s.prototype.neq=s.prototype.notEquals,s.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=s.prototype.gt=s.prototype.greater,s.prototype.lesser=function(t){return this.compare(t)<0},l.prototype.lt=l.prototype.lesser=s.prototype.lt=s.prototype.lesser,s.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals,s.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},l.prototype.leq=l.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals,s.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},s.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},s.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},s.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},s.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},s.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},s.prototype.isDivisibleBy=function(t){var e=$(t),n=e.value;return 0!==n&&(1===n||(2===n?this.isEven():this.mod(e).equals(a[0])))},l.prototype.isDivisibleBy=s.prototype.isDivisibleBy,s.prototype.isPrime=function(){var t=L(this);if(void 0!==t)return t;for(var e,n,r,o,i=this.abs(),s=i.prev(),l=[2,3,5,7,11,13,17,19],u=s;u.isEven();)u=u.divide(2);for(r=0;r<l.length;r++)if(!(o=bigInt(l[r]).modPow(u,i)).equals(a[1])&&!o.equals(s)){for(n=!0,e=u;n&&e.lesser(s);e=e.multiply(2))(o=o.square().mod(i)).equals(s)&&(n=!1);if(n)return!1}return!0},l.prototype.isPrime=s.prototype.isPrime,s.prototype.isProbablePrime=function(t){var e=L(this);if(void 0!==e)return e;for(var n=this.abs(),r=void 0===t?5:t,o=0;o<r;o++){if(!bigInt.randBetween(2,n.minus(2)).modPow(n.prev(),n).isUnit())return!1}return!0},l.prototype.isProbablePrime=s.prototype.isProbablePrime,s.prototype.modInv=function(t){for(var e,n,r,o=bigInt.zero,i=bigInt.one,a=$(t),s=this.abs();!s.equals(bigInt.zero);)e=a.divide(s),n=o,r=a,o=i,a=s,i=n.subtract(e.multiply(i)),s=r.subtract(e.multiply(s));if(!a.equals(1))throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===o.compare(0)&&(o=o.add(t)),this.isNegative()?o.negate():o},l.prototype.modInv=s.prototype.modInv,s.prototype.next=function(){var t=this.value;return this.sign?b(t,1,this.sign):new s(m(t,1),this.sign)},l.prototype.next=function(){var t=this.value;return t+1<r?new l(t+1):new s(o,!1)},s.prototype.prev=function(){var t=this.value;return this.sign?new s(m(t,1),!0):b(t,1,this.sign)},l.prototype.prev=function(){var t=this.value;return t-1>-r?new l(t-1):new s(o,!0)};for(var I=[1];2*I[I.length-1]<=e;)I.push(2*I[I.length-1]);var C=I.length,k=I[C-1];function A(t){return("number"==typeof t||"string"==typeof t)&&+Math.abs(t)<=e||t instanceof s&&t.value.length<=1}function N(t,e,n){e=$(e);for(var r=t.isNegative(),o=e.isNegative(),i=r?t.not():t,a=o?e.not():e,s=0,l=0,u=null,c=null,p=[];!i.isZero()||!a.isZero();)s=(u=T(i,k))[1].toJSNumber(),r&&(s=k-1-s),l=(c=T(a,k))[1].toJSNumber(),o&&(l=k-1-l),i=u[0],a=c[0],p.push(n(s,l));for(var h=0!==n(r?1:0,o?1:0)?bigInt(-1):bigInt(0),d=p.length-1;d>=0;d-=1)h=h.multiply(k).add(bigInt(p[d]));return h}s.prototype.shiftLeft=function(t){if(!A(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftRight(-t);for(var e=this;t>=C;)e=e.multiply(k),t-=C-1;return e.multiply(I[t])},l.prototype.shiftLeft=s.prototype.shiftLeft,s.prototype.shiftRight=function(t){var e;if(!A(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftLeft(-t);for(var n=this;t>=C;){if(n.isZero())return n;n=(e=T(n,k))[1].isNegative()?e[0].prev():e[0],t-=C-1}return(e=T(n,I[t]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=s.prototype.shiftRight,s.prototype.not=function(){return this.negate().prev()},l.prototype.not=s.prototype.not,s.prototype.and=function(t){return N(this,t,function(t,e){return t&e})},l.prototype.and=s.prototype.and,s.prototype.or=function(t){return N(this,t,function(t,e){return t|e})},l.prototype.or=s.prototype.or,s.prototype.xor=function(t){return N(this,t,function(t,e){return t^e})},l.prototype.xor=s.prototype.xor;var j=1<<30,O=(e&-e)*(e&-e)|j;function P(t){var n=t.value,r="number"==typeof n?n|j:n[0]+n[1]*e|O;return r&-r}function B(t,e){return t=$(t),e=$(e),t.greater(e)?t:e}function H(t,e){return t=$(t),e=$(e),t.lesser(e)?t:e}function U(t,e){if(t=$(t).abs(),e=$(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var n,r,o=a[1];t.isEven()&&e.isEven();)n=Math.min(P(t),P(e)),t=t.divide(n),e=e.divide(n),o=o.multiply(n);for(;t.isEven();)t=t.divide(P(t));do{for(;e.isEven();)e=e.divide(P(e));t.greater(e)&&(r=e,e=t,t=r),e=e.subtract(t)}while(!e.isZero());return o.isUnit()?t:t.multiply(o)}var R=function(t,e){for(var n=t.length,r=Math.abs(e),o=0;o<n;o++){if("-"!==(c=t[o].toLowerCase())&&/[a-z0-9]/.test(c)){if(/[0-9]/.test(c)&&+c>=r){if("1"===c&&1===r)continue;throw new Error(c+" is not a valid digit in base "+e+".")}if(c.charCodeAt(0)-87>=r)throw new Error(c+" is not a valid digit in base "+e+".")}}if(2<=e&&e<=36&&n<=i/Math.log(e)){var a=parseInt(t,e);if(isNaN(a))throw new Error(c+" is not a valid digit in base "+e+".");return new l(parseInt(t,e))}e=$(e);var s=[],u="-"===t[0];for(o=u?1:0;o<t.length;o++){var c,p=(c=t[o].toLowerCase()).charCodeAt(0);if(48<=p&&p<=57)s.push($(c));else if(97<=p&&p<=122)s.push($(c.charCodeAt(0)-87));else{if("<"!==c)throw new Error(c+" is not a valid character");var h=o;do{o++}while(">"!==t[o]);s.push($(t.slice(h+1,o)))}}return Z(s,e,u)};function Z(t,e,n){var r,o=a[0],i=a[1];for(r=t.length-1;r>=0;r--)o=o.add(t[r].times(i)),i=i.times(e);return n?o.negate():o}function z(t){var e=t.value;return"number"==typeof e&&(e=[e]),1===e.length&&e[0]<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e[0]):"<"+e+">"}function F(t,e){if((e=bigInt(e)).isZero()){if(t.isZero())return"0";throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1))return t.isZero()?"0":t.isNegative()?new Array(1-t).join("10"):"1"+new Array(+t).join("01");var n="";if(t.isNegative()&&e.isPositive()&&(n="-",t=t.abs()),e.equals(1))return t.isZero()?"0":n+new Array(+t+1).join(1);for(var r,o=[],i=t;i.isNegative()||i.compareAbs(e)>=0;){r=i.divmod(e),i=r.quotient;var a=r.remainder;a.isNegative()&&(a=e.minus(a).abs(),i=i.next()),o.push(z(a))}return o.push(z(i)),n+o.reverse().join("")}function J(t){if(u(+t)){var e=+t;if(e===f(e))return new l(e);throw"Invalid integer: "+t}var r="-"===t[0];r&&(t=t.slice(1));var o=t.split(/e/i);if(o.length>2)throw new Error("Invalid integer: "+o.join("e"));if(2===o.length){var i=o[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==f(i)||!u(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var a=o[0],c=a.indexOf(".");if(c>=0&&(i-=a.length-c-1,a=a.slice(0,c)+a.slice(c+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=a+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);for(var p=[],d=t.length,v=n,g=d-v;d>0;)p.push(+t.slice(g,d)),(g-=v)<0&&(g=0),d-=v;return h(p),new s(p,r)}function $(t){return"number"==typeof t?function(t){if(u(t)){if(t!==f(t))throw new Error(t+" is not an integer.");return new l(t)}return J(t.toString())}(t):"string"==typeof t?J(t):t}s.prototype.toString=function(t){if(void 0===t&&(t=10),10!==t)return F(this,t);for(var e,n=this.value,r=n.length,o=String(n[--r]);--r>=0;)e=String(n[r]),o+="0000000".slice(e.length)+e;return(this.sign?"-":"")+o},l.prototype.toString=function(t){return void 0===t&&(t=10),10!=t?F(this,t):String(this.value)},s.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},s.prototype.valueOf=function(){return+this.toString()},s.prototype.toJSNumber=s.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf;for(var D=0;D<1e3;D++)a[D]=new l(D),D>0&&(a[-D]=new l(-D));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=B,a.min=H,a.gcd=U,a.lcm=function(t,e){return t=$(t).abs(),e=$(e).abs(),t.divide(U(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof s||t instanceof l},a.randBetween=function(t,n){var r=H(t=$(t),n=$(n)),o=B(t,n).subtract(r).add(1);if(o.isSmall)return r.add(Math.floor(Math.random()*o));for(var i=[],a=!0,u=o.value.length-1;u>=0;u--){var c=a?o.value[u]:e,h=f(Math.random()*c);i.unshift(h),h<c&&(a=!1)}return i=p(i),r.add("number"==typeof i?new l(i):new s(i,!1))},a.fromArray=function(t,e,n){return Z(t.map($),$(e||10),n)},a}();"undefined"!=typeof module&&module.hasOwnProperty("exports")&&(module.exports=bigInt),"function"==typeof define&&define.amd&&define("big-integer",[],function(){return bigInt}),function(t){function e(t,e){var n=typeof t[e];return"function"===n||!("object"!=n||!t[e])||"unknown"==n}function n(t,e){return typeof t[e]!=g}function r(t,e){return!("object"!=typeof t[e]||!t[e])}function o(t,e,n){return 0>e&&(e+=t.value.length),typeof n==g&&(n=e),0>n&&(n+=t.value.length),{start:e,end:n}}function i(t,e,n){return{start:e,end:n,length:n-e,text:t.value.slice(e,n)}}function a(){return r(document,"body")?document.body:document.getElementsByTagName("body")[0]}var s,l,u,c,p,h,d,f,v,g="undefined";t(document).ready(function(){function m(t,e){var n=t.value,r=s(t),o=r.start;return{value:n.slice(0,o)+e+n.slice(r.end),index:o,replaced:r.text}}function y(t,e){t.focus();var n=s(t);return l(t,n.start,n.end),""==e?document.execCommand("delete",!1,null):document.execCommand("insertText",!1,e),{replaced:n.text,index:n.start}}function b(t,e){t.focus();var n=m(t,e);return t.value=n.value,n}function w(t,e){return function(){var n=this.jquery?this[0]:this,r=n.nodeName.toLowerCase();if(1==n.nodeType&&("textarea"==r||"input"==r&&/^(?:text|email|number|search|tel|url|password)$/i.test(n.type))){var o=[n].concat(Array.prototype.slice.call(arguments)),i=t.apply(this,o);if(!e)return i}return e?this:void 0}}var x=document.createElement("textarea");if(a().appendChild(x),n(x,"selectionStart")&&n(x,"selectionEnd"))s=function(t){return i(t,t.selectionStart,t.selectionEnd)},l=function(t,e,n){var r=o(t,e,n);t.selectionStart=r.start,t.selectionEnd=r.end},v=function(t,e){e?t.selectionEnd=t.selectionStart:t.selectionStart=t.selectionEnd};else{if(!(e(x,"createTextRange")&&r(document,"selection")&&e(document.selection,"createRange")))return a().removeChild(x),void function(t){window.console&&window.console.log&&window.console.log("RangyInputs not supported in your browser. Reason: "+t)}("No means of finding text input caret position");s=function(t){var e,n,r,o,a=0,s=0,l=document.selection.createRange();return l&&l.parentElement()==t&&(r=t.value.length,e=t.value.replace(/\r\n/g,"\n"),(n=t.createTextRange()).moveToBookmark(l.getBookmark()),(o=t.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",o)>-1?a=s=r:(a=-n.moveStart("character",-r),a+=e.slice(0,a).split("\n").length-1,n.compareEndPoints("EndToEnd",o)>-1?s=r:(s=-n.moveEnd("character",-r),s+=e.slice(0,s).split("\n").length-1))),i(t,a,s)};var S=function(t,e){return e-(t.value.slice(0,e).split("\r\n").length-1)};l=function(t,e,n){var r=o(t,e,n),i=t.createTextRange(),a=S(t,r.start);i.collapse(!0),r.start==r.end?i.move("character",a):(i.moveEnd("character",S(t,r.end)),i.moveStart("character",a)),i.select()},v=function(t,e){var n=document.selection.createRange();n.collapse(e),n.select()}}a().removeChild(x);var _=function(t,e){var n=m(t,e);try{var r=y(t,e);if(t.value==n.value)return _=y,r}catch(t){}return _=b,t.value=n.value,n};c=function(t,e,n,r){e!=n&&(l(t,e,n),_(t,"")),r&&l(t,e)},u=function(t){l(t,_(t,"").index)},f=function(t){var e=_(t,"");return l(t,e.index),e.replaced};var q=function(t,e,n,r){var o=e+n.length;if(("collapsetoend"==(r="string"==typeof r?r.toLowerCase():"")||"select"==r)&&/[\r\n]/.test(n)){var i=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n");o=e+i.length;var a=e+i.indexOf("\n");"\r\n"==t.value.slice(a,a+2)&&(o+=i.match(/\n/g).length)}switch(r){case"collapsetostart":l(t,e,e);break;case"collapsetoend":l(t,o,o);break;case"select":l(t,e,o)}};p=function(t,e,n,r){l(t,n),_(t,e),"boolean"==typeof r&&(r=r?"collapseToEnd":""),q(t,n,e,r)},h=function(t,e,n){var r=_(t,e);q(t,r.index,e,n||"collapseToEnd")},d=function(t,e,n,r){typeof n==g&&(n=e);var o=s(t),i=_(t,e+o.text+n);q(t,i.index+e.length,o.text,r||"select")},t.fn.extend({getSelection:w(s,!1),setSelection:w(l,!0),collapseSelection:w(v,!0),deleteSelectedText:w(u,!0),deleteText:w(c,!0),extractSelectedText:w(f,!1),insertText:w(p,!0),replaceSelectedText:w(h,!0),surroundSelectedText:w(d,!0)})})}(jQuery),function(t){function e(t){return t.clone().css({position:"absolute"})}function n(t){return t.split(/\s+/)}function r(e,n){return t(e="<div>"+e).find('*:not(:has("*"))').html(n).parentsUntil().slice(-1).html()}t.fn.splitLines=function(o){var i={width:"auto",tag:"<div>",wrap:"",keepHtml:!0};o&&t.extend(i,o);var a=e(this),s=this.contents(),l=this.text();this.append(a),a.text("42");var u=a.height()+2;a.empty();var c=e(a);"auto"!==i.width&&c.width(i.width),this.append(c);for(var p,h=i.keepHtml?function e(r){for(var o,i=[],a=0;a<r.length;a++)if("BR"!==r[a].nodeName){if(3==r[a].nodeType)o=n(r[a].textContent||r[a].toString());else{var s=t(r[a]).clone();o=e(s.contents());for(var l=0;l<o.length;l++)s.empty(),o[l]=s.html(o[l]).wrap("<p></p>").parent().html()}for(var u=0;u<o.length;u++)""!==o[u]&&i.push(o[u])}else i.push("<br>");return i}(s):n(l),d=0;d<h.length;d++){var f=c.html();c.html(f+h[d]+" "),c.html()!=p?c.height()>u&&(p=c.html(),c.html(f),a.append(r(i.tag,c.html())),c.html(""),d--):(p="",a.append(r(i.tag,c.html())),c.html(""))}a.append(r(i.tag,c.html())),this.html(a.html())}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){class e{constructor({id:t}){this.el=document.getElementById(t),this.cache="",this.cacheFromUrl="",this.responseText="",this.el&&(this.mode=this.el.dataset.mode,this._initEvents(),this._renderLayout(this.el.innerHTML),"readonly"===this.mode?this.convert():this.el.dataset.postId&&this.invert())}_initEvents(){this.el.addEventListener("click",this._onClick.bind(this)),document.body.addEventListener("click",this._onClickGlobal.bind(this))}_onClick(t){const e=t.target.dataset.action&&t.target||t.target.closest("[data-action]"),n=e?e.dataset.action:null;n&&void 0!==this[n]&&this[n].call(this,t,e)}_onClickGlobal(t){const e=t.target.dataset.stcAction&&t.target||t.target.closest("[data-stc-action]"),n=e?e.dataset.stcAction:null;n&&void 0!==this[n]&&this[n].call(this,t,e)}_renderLayout(t=""){""!==this.cacheFromUrl&&(t=this.cacheFromUrl.replace(/<p>/g,"").replace(/<\/p>/g,"\n").replace(/<br>/g,"\n"));this.el.classList.add("stc"),this.el.innerHTML=`\n        <div class="stc--box">\n          <div class="stc--area stc--area__input">\n            <div class="stc--element">\n              \n              <div class="stc--panel stc--panel__image" hidden>\n                <button \n                  class="button button_secondary button_icon" \n                  data-action="addIsActiveClass" \n                  data-stc="alignleft">\n                    <i class="fas fa-align-left"></i>\n                </button>\n                \n                <button \n                  class="button button_secondary button_icon" \n                  data-action="addIsActiveClass" \n                  data-stc="aligncenter">\n                    <i class="fas fa-align-center"></i>\n                </button>\n                \n                <button \n                  class="button button_secondary button_icon" \n                  data-action="addIsActiveClass" \n                  data-stc="alignright">\n                    <i class="fas fa-align-right"></i>\n                </button>\n              </div>\n            </div>\n\n            <div class="stc--element">\n              <textarea\n                  placeholder="Type or copy/paste in your text here and click the Convert buttonâ€¦"\n                  name="stc"\n                  id="stc"\n                  cols="30"\n                  rows="10"\n                  class="stc--element__textarea">${t}</textarea>\n            </div>\n          </div>\n        </div>\n      `}convert(t,n){n&&(n.dataset.stcAction="backToTextarea",n.innerText="Back to Editor"),e.toggleSaveButton(),this._checkInputIfUrl()}invert(){this.convert(null,document.querySelector('[data-stc-action="convert"]'))}static toggleSaveButton(){const t=document.querySelector(".header");t&&(t.querySelector(".header--save-panel").classList.toggle("hidden"),t.classList.toggle("is-save-panel"))}save(e){var n=e.target,r=document.querySelector('[name="post_title"]').value,o=document.querySelector('[name="post_public"]').checked,i={action:"save_sta_document",document:this.cache,post_title:r,post_status:o?"publish":"private",post_id:this.el.dataset.postId||!1};t.ajax({method:"post",url:window.sta.ajax,data:i,beforeSend:function(){n.setAttribute("disabled","disabled")},complete:function(t){var e=JSON.parse(t.responseText);e.error?alert(e.error):e.redirect&&(window.location.href=e.redirect),n.removeAttribute("disabled")}})}backToTextarea(t,n){n.dataset.stcAction="convert",n.innerText="Convert",e.toggleSaveButton(),this._renderLayout(this.cache),this.cache="",this.cacheFromUrl=""}showOutputTab(t,e){this.el.querySelector(".stc--element__output--text").hidden=!1,this.el.querySelector(".stc--element__output--code").hidden=!0,this.addIsActiveClass(t,e)}showCodeTab(t,e){this.el.querySelector(".stc--element__output--code").hidden=!1,this.el.querySelector(".stc--element__output--text").hidden=!0,this.addIsActiveClass(t,e)}_checkInputIfUrl(){this.el.querySelector(".stc--box");const e=this.el.querySelector(".stc--element__textarea").value;let n=this;const r=e.replace(/<\/?[^>]+(>|$)/g,"");let o,i=!1;if(r.match(/https:\/\/ndla.no\/subjects\/subject:[0-9]/g)&&(i=!0,o="ndla.no"),i){const e={action:"get_data_from_other_site",link:r,domainName:o};t.ajax({method:"GET",url:window.sta.ajax,data:e,beforeSend:function(){let e=document.createElement("div"),n=document.createElement("div");e.classList.add("magic-screen"),e.innerHTML="Please wait. We are processing your request....",n.classList.add("js-loading-big"),e.prepend(n),t("body").append(e)},complete:function(e){let r=JSON.parse(e.responseText);if(console.debug(r),!0===r.status)n.el.classList.remove("js-loading-big"),t(".magic-screen").remove(),r.text=r.text.replace(/<p>/g,"").replace(/<\/p>/g,"\n"),n.responseText=r.text,n.cacheFromUrl=n.handleHTML(r.text),n._convertTextarea();else{let t=document.querySelector(".magic-screen");t.innerHTML=r.text,t.classList.add("smaller-text"),t.onclick=(()=>{t.remove()})}}})}else this._convertTextarea()}_convertTextarea(){const e=this.el.querySelector(".stc--box"),n=this.el.querySelector(".stc--element__textarea"),r=n.value;""!==this.cacheFromUrl?(this.output=this.cacheFromUrl,this.cache=this.cacheFromUrl):(this.output=this.handleHTML(r),this.cache=n.value);e.innerHTML=`\n        <div class="stc--area stc--area__output">\n          <div class="stc--element stc--element__output stc--element__output--text"> \n            ${this.output}\n          </div>\n\n          <div class="stc--element stc--element__output stc--element__output--code" hidden>\n            <textarea\n                name="stc-html-output"\n                id="stc"\n                cols="30"\n                rows="10"\n                class="stc--element__textarea"\n                readonly></textarea>\n          </div>\n        </div>\n      `;const o=t(".stc--element__output--text");o.find("p, h1, h2, h3, h4, h5, h6").each(function(){t(this).splitLines({tag:'<span class="switcher-line">',keepHtml:!0,width:o.width()})}),o.find("p").each(function(){t(this).find(".switcher-line").each(function(e){[].forEach.call(this.childNodes,e=>{" "===e.textContent&&null!==e.previousElementSibling&&"BR"===e.previousElementSibling.nodeName&&null===e.previousElementSibling.previousSibling&&t(e.parentNode).replaceWith(t("<br>"))})})}),t('[name="stc-html-output"]').html(o[0].innerHTML)}wrapSelectedByBold(){const e=this.el.querySelector(".stc--element__textarea");t(e).surroundSelectedText("[bold]","[/bold]")}wrapSelectedByP(){const e=this.el.querySelector(".stc--element__textarea");t(e).surroundSelectedText("<p>","</p>")}getSelection(){const e=this.el.querySelector(".stc--element__textarea");return t(e).getSelection()}insertImage(){const e=this.el.querySelector(".stc--element__textarea"),n=this.el.querySelector(".stc--panel__textarea"),r=this.el.querySelector(".stc--panel__image"),o=e.parentElement,i=this.getSelection().start;this.showImageUrlInput({onInit:()=>{o.hidden=!0,n.hidden=!0,r.hidden=!1,o.insertAdjacentHTML("afterEnd",'\n            <div class="stc--element stc--element__input-url">\n              <input type="url" name="stc-url" class="stc--element__input" placeholder="https://www.path.to/image.jpg">\n              <div class="stc--element__buttons">\n                <button class="button button_primary button_icon"><i class="fas fa-check"></i></button>\n                <button class="button button_secondary button_icon"><i class="fas fa-times"></i></button>\n              </div>\n            </div>\n          ')},onInsert:(n,r)=>{t(e).insertText(`<img src="${n}" class="${r}" alt='' />`,i,"collapseToEnd")},onClose:()=>{o.hidden=!1,n.hidden=!1,r.hidden=!0,this.el.querySelector(".stc--element__input-url").remove()}})}showImageUrlInput({onInit:t,onInsert:e,onClose:n}){t();const r=this.el.querySelector(".stc--element__input-url");r&&r.addEventListener("click",function(t){const o=t.target.classList.contains("fas")?t.target:t.target.children[0];if(void 0!==o&&o.classList.contains("fas")){if(o.classList.contains("fa-check")){const t=r.querySelector('[name="stc-url"]').value,n=document.querySelector(".stc--panel__image"),o=n.querySelector(".is-active")?n.querySelector(".is-active").dataset.stc:"alignnone";o&&e(t,o)}n()}})}addIsActiveClass(t,e){[].forEach.call(e.parentNode.children,t=>t.classList.remove("is-active")),e.classList.add("is-active")}handleHTML(e){const n=t(`<div>${e}</div>`);return[].forEach.call(n[0].childNodes,function(e){"#text"===e.nodeName&&e.textContent.match(/[a-z]/i)&&t(e).wrap("<p></p>")}),n[0].innerHTML=n[0].innerHTML.replace(/\[bold\]/g,"<b>").replace(/\[\/bold\]/g,"</b>"),n.find("p, h1, h2, h3, h4, h5, h6, b").each(function(){this.innerHTML=this.innerHTML.replace(/\r?\n/g,"<br/>")}),n[0].innerHTML=n[0].innerHTML.replace(/<p><br>/g,"<p>"),n[0].innerHTML=n[0].innerHTML.replace(/<br><\/p>/g,"</p>"),n[0].innerHTML}}window.SimpleTextConverter=e}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){new(0,window.SimpleTextConverter)({id:"stc"}),t("body").attr("data-form-style","none")});
//# sourceMappingURL=sourcemaps/simple-text-converter-public.js.map
