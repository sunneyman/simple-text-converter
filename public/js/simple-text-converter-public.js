"use strict";var bigInt=function(t){var e=1e7,n=7,r=9007199254740992,o=c(r),i=Math.log(r);function a(t,e){return void 0===t?a[0]:void 0!==e?10==+e?D(t):Z(t,e):D(t)}function s(t,e){this.value=t,this.sign=e,this.isSmall=!1}function u(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){return-r<t&&t<r}function c(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function p(t){h(t);var n=t.length;if(n<4&&T(t,o)<0)switch(n){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function h(t){for(var e=t.length;0===t[--e];);t.length=e+1}function d(t){for(var e=new Array(t),n=-1;++n<t;)e[n]=0;return e}function f(t){return t>0?Math.floor(t):Math.ceil(t)}function v(t,n){var r,o,i=t.length,a=n.length,s=new Array(i),u=0,l=e;for(o=0;o<a;o++)u=(r=t[o]+n[o]+u)>=l?1:0,s[o]=r-u*l;for(;o<i;)u=(r=t[o]+u)===l?1:0,s[o++]=r-u*l;return u>0&&s.push(u),s}function g(t,e){return t.length>=e.length?v(t,e):v(e,t)}function y(t,n){var r,o,i=t.length,a=new Array(i),s=e;for(o=0;o<i;o++)r=t[o]-s+n,n=Math.floor(r/s),a[o]=r-n*s,n+=1;for(;n>0;)a[o++]=n%s,n=Math.floor(n/s);return a}function m(t,n){var r,o,i=t.length,a=n.length,s=new Array(i),u=0,l=e;for(r=0;r<a;r++)(o=t[r]-u-n[r])<0?(o+=l,u=1):u=0,s[r]=o;for(r=a;r<i;r++){if(!((o=t[r]-u)<0)){s[r++]=o;break}o+=l,s[r]=o}for(;r<i;r++)s[r]=t[r];return h(s),s}function b(t,n,r){var o,i,a=t.length,l=new Array(a),c=-n,h=e;for(o=0;o<a;o++)i=t[o]+c,c=Math.floor(i/h),i%=h,l[o]=i<0?i+h:i;return"number"==typeof(l=p(l))?(r&&(l=-l),new u(l)):new s(l,r)}function w(t,n){var r,o,i,a,s=t.length,u=n.length,l=d(s+u),c=e;for(i=0;i<s;++i){a=t[i];for(var p=0;p<u;++p)r=a*n[p]+l[i+p],o=Math.floor(r/c),l[i+p]=r-o*c,l[i+p+1]+=o}return h(l),l}function S(t,n){var r,o,i=t.length,a=new Array(i),s=e,u=0;for(o=0;o<i;o++)r=t[o]*n+u,u=Math.floor(r/s),a[o]=r-u*s;for(;u>0;)a[o++]=u%s,u=Math.floor(u/s);return a}function x(t,e){for(var n=[];e-- >0;)n.push(0);return n.concat(t)}function _(t,n,r){return new s(t<e?S(n,t):w(n,c(t)),r)}function q(t){var n,r,o,i,a=t.length,s=d(a+a),u=e;for(o=0;o<a;o++){i=t[o];for(var l=0;l<a;l++)n=i*t[l]+s[o+l],r=Math.floor(n/u),s[o+l]=n-r*u,s[o+l+1]+=r}return h(s),s}function E(t,n){var r,o,i,a,s=t.length,u=d(s),l=e;for(i=0,r=s-1;r>=0;--r)i=(a=i*l+t[r])-(o=f(a/n))*n,u[r]=0|o;return[u,0|i]}function M(t,n){var r,o,i=D(n),l=t.value,v=i.value;if(0===v)throw new Error("Cannot divide by zero");if(t.isSmall)return i.isSmall?[new u(f(l/v)),new u(l%v)]:[a[0],t];if(i.isSmall){if(1===v)return[t,a[0]];if(-1==v)return[t.negate(),a[0]];var g=Math.abs(v);if(g<e){o=p((r=E(l,g))[0]);var y=r[1];return t.sign&&(y=-y),"number"==typeof o?(t.sign!==i.sign&&(o=-o),[new u(o),new u(y)]):[new s(o,t.sign!==i.sign),new u(y)]}v=c(g)}var b=T(l,v);if(-1===b)return[a[0],t];if(0===b)return[a[t.sign===i.sign?1:-1],a[0]];o=(r=l.length+v.length<=200?function(t,n){var r,o,i,a,s,u,l,c=t.length,h=n.length,f=e,v=d(n.length),g=n[h-1],y=Math.ceil(f/(2*g)),m=S(t,y),b=S(n,y);for(m.length<=c&&m.push(0),b.push(0),g=b[h-1],o=c-h;o>=0;o--){for(r=f-1,m[o+h]!==g&&(r=Math.floor((m[o+h]*f+m[o+h-1])/g)),i=0,a=0,u=b.length,s=0;s<u;s++)i+=r*b[s],l=Math.floor(i/f),a+=m[o+s]-(i-l*f),i=l,a<0?(m[o+s]=a+f,a=-1):(m[o+s]=a,a=0);for(;0!==a;){for(r-=1,i=0,s=0;s<u;s++)(i+=m[o+s]-f+b[s])<0?(m[o+s]=i+f,i=0):(m[o+s]=i,i=1);a+=i}v[o]=r}return m=E(m,y)[0],[p(v),p(m)]}(l,v):function(t,n){for(var r,o,i,a,s,u=t.length,l=n.length,c=[],d=[],f=e;u;)if(d.unshift(t[--u]),h(d),T(d,n)<0)c.push(0);else{i=d[(o=d.length)-1]*f+d[o-2],a=n[l-1]*f+n[l-2],o>l&&(i=(i+1)*f),r=Math.ceil(i/a);do{if(T(s=S(n,r),d)<=0)break;r--}while(r);c.push(r),d=m(d,s)}return c.reverse(),[p(c),p(d)]}(l,v))[0];var w=t.sign!==i.sign,x=r[1],_=t.sign;return"number"==typeof o?(w&&(o=-o),o=new u(o)):o=new s(o,w),"number"==typeof x?(_&&(x=-x),x=new u(x)):x=new s(x,_),[o,x]}function T(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n])return t[n]>e[n]?1:-1;return 0}function I(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(25)||void 0))}s.prototype=Object.create(a.prototype),u.prototype=Object.create(a.prototype),s.prototype.add=function(t){var e=D(t);if(this.sign!==e.sign)return this.subtract(e.negate());var n=this.value,r=e.value;return e.isSmall?new s(y(n,Math.abs(r)),this.sign):new s(g(n,r),this.sign)},s.prototype.plus=s.prototype.add,u.prototype.add=function(t){var e=D(t),n=this.value;if(n<0!==e.sign)return this.subtract(e.negate());var r=e.value;if(e.isSmall){if(l(n+r))return new u(n+r);r=c(Math.abs(r))}return new s(y(r,Math.abs(n)),n<0)},u.prototype.plus=u.prototype.add,s.prototype.subtract=function(t){var e=D(t);if(this.sign!==e.sign)return this.add(e.negate());var n=this.value,r=e.value;return e.isSmall?b(n,Math.abs(r),this.sign):function(t,e,n){var r;return T(t,e)>=0?r=m(t,e):(r=m(e,t),n=!n),"number"==typeof(r=p(r))?(n&&(r=-r),new u(r)):new s(r,n)}(n,r,this.sign)},s.prototype.minus=s.prototype.subtract,u.prototype.subtract=function(t){var e=D(t),n=this.value;if(n<0!==e.sign)return this.add(e.negate());var r=e.value;return e.isSmall?new u(n-r):b(r,Math.abs(n),n>=0)},u.prototype.minus=u.prototype.subtract,s.prototype.negate=function(){return new s(this.value,!this.sign)},u.prototype.negate=function(){var t=this.sign,e=new u(-this.value);return e.sign=!t,e},s.prototype.abs=function(){return new s(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},s.prototype.multiply=function(t){var n,r,o,i=D(t),u=this.value,l=i.value,p=this.sign!==i.sign;if(i.isSmall){if(0===l)return a[0];if(1===l)return this;if(-1===l)return this.negate();if((n=Math.abs(l))<e)return new s(S(u,n),p);l=c(n)}return r=u.length,o=l.length,new s(-.012*r-.012*o+15e-6*r*o>0?function t(e,n){var r=Math.max(e.length,n.length);if(r<=30)return w(e,n);r=Math.ceil(r/2);var o=e.slice(r),i=e.slice(0,r),a=n.slice(r),s=n.slice(0,r),u=t(i,s),l=t(o,a),c=t(g(i,o),g(s,a)),p=g(g(u,x(m(m(c,u),l),r)),x(l,2*r));return h(p),p}(u,l):w(u,l),p)},s.prototype.times=s.prototype.multiply,u.prototype._multiplyBySmall=function(t){return l(t.value*this.value)?new u(t.value*this.value):_(Math.abs(t.value),c(Math.abs(this.value)),this.sign!==t.sign)},s.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():_(Math.abs(t.value),this.value,this.sign!==t.sign)},u.prototype.multiply=function(t){return D(t)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,s.prototype.square=function(){return new s(q(this.value),!1)},u.prototype.square=function(){var t=this.value*this.value;return l(t)?new u(t):new s(q(c(Math.abs(this.value))),!1)},s.prototype.divmod=function(t){var e=M(this,t);return{quotient:e[0],remainder:e[1]}},u.prototype.divmod=s.prototype.divmod,s.prototype.divide=function(t){return M(this,t)[0]},u.prototype.over=u.prototype.divide=s.prototype.over=s.prototype.divide,s.prototype.mod=function(t){return M(this,t)[1]},u.prototype.remainder=u.prototype.mod=s.prototype.remainder=s.prototype.mod,s.prototype.pow=function(t){var e,n,r,o=D(t),i=this.value,s=o.value;if(0===s)return a[1];if(0===i)return a[0];if(1===i)return a[1];if(-1===i)return o.isEven()?a[1]:a[-1];if(o.sign)return a[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&l(e=Math.pow(i,s)))return new u(f(e));for(n=this,r=a[1];!0&s&&(r=r.times(n),--s),0!==s;)s/=2,n=n.square();return r},u.prototype.pow=s.prototype.pow,s.prototype.modPow=function(t,e){if(t=D(t),(e=D(e)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var n=a[1],r=this.mod(e);t.isPositive();){if(r.isZero())return a[0];t.isOdd()&&(n=n.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return n},u.prototype.modPow=s.prototype.modPow,s.prototype.compareAbs=function(t){var e=D(t),n=this.value,r=e.value;return e.isSmall?1:T(n,r)},u.prototype.compareAbs=function(t){var e=D(t),n=Math.abs(this.value),r=e.value;return e.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},s.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=D(t),n=this.value,r=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:T(n,r)*(this.sign?-1:1)},s.prototype.compareTo=s.prototype.compare,u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=D(t),n=this.value,r=e.value;return e.isSmall?n==r?0:n>r?1:-1:n<0!==e.sign?n<0?-1:1:n<0?1:-1},u.prototype.compareTo=u.prototype.compare,s.prototype.equals=function(t){return 0===this.compare(t)},u.prototype.eq=u.prototype.equals=s.prototype.eq=s.prototype.equals,s.prototype.notEquals=function(t){return 0!==this.compare(t)},u.prototype.neq=u.prototype.notEquals=s.prototype.neq=s.prototype.notEquals,s.prototype.greater=function(t){return this.compare(t)>0},u.prototype.gt=u.prototype.greater=s.prototype.gt=s.prototype.greater,s.prototype.lesser=function(t){return this.compare(t)<0},u.prototype.lt=u.prototype.lesser=s.prototype.lt=s.prototype.lesser,s.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},u.prototype.geq=u.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals,s.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},u.prototype.leq=u.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals,s.prototype.isEven=function(){return 0==(1&this.value[0])},u.prototype.isEven=function(){return 0==(1&this.value)},s.prototype.isOdd=function(){return 1==(1&this.value[0])},u.prototype.isOdd=function(){return 1==(1&this.value)},s.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},s.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},s.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},s.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},s.prototype.isDivisibleBy=function(t){var e=D(t),n=e.value;return 0!==n&&(1===n||(2===n?this.isEven():this.mod(e).equals(a[0])))},u.prototype.isDivisibleBy=s.prototype.isDivisibleBy,s.prototype.isPrime=function(){var t=I(this);if(void 0!==t)return t;for(var e,n,r,o,i=this.abs(),s=i.prev(),u=[2,3,5,7,11,13,17,19],l=s;l.isEven();)l=l.divide(2);for(r=0;r<u.length;r++)if(!(o=bigInt(u[r]).modPow(l,i)).equals(a[1])&&!o.equals(s)){for(n=!0,e=l;n&&e.lesser(s);e=e.multiply(2))(o=o.square().mod(i)).equals(s)&&(n=!1);if(n)return!1}return!0},u.prototype.isPrime=s.prototype.isPrime,s.prototype.isProbablePrime=function(t){var e=I(this);if(void 0!==e)return e;for(var n=this.abs(),r=void 0===t?5:t,o=0;o<r;o++){if(!bigInt.randBetween(2,n.minus(2)).modPow(n.prev(),n).isUnit())return!1}return!0},u.prototype.isProbablePrime=s.prototype.isProbablePrime,s.prototype.modInv=function(t){for(var e,n,r,o=bigInt.zero,i=bigInt.one,a=D(t),s=this.abs();!s.equals(bigInt.zero);)e=a.divide(s),n=o,r=a,o=i,a=s,i=n.subtract(e.multiply(i)),s=r.subtract(e.multiply(s));if(!a.equals(1))throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===o.compare(0)&&(o=o.add(t)),this.isNegative()?o.negate():o},u.prototype.modInv=s.prototype.modInv,s.prototype.next=function(){var t=this.value;return this.sign?b(t,1,this.sign):new s(y(t,1),this.sign)},u.prototype.next=function(){var t=this.value;return t+1<r?new u(t+1):new s(o,!1)},s.prototype.prev=function(){var t=this.value;return this.sign?new s(y(t,1),!0):b(t,1,this.sign)},u.prototype.prev=function(){var t=this.value;return t-1>-r?new u(t-1):new s(o,!0)};for(var L=[1];2*L[L.length-1]<=e;)L.push(2*L[L.length-1]);var C=L.length,A=L[C-1];function N(t){return("number"==typeof t||"string"==typeof t)&&+Math.abs(t)<=e||t instanceof s&&t.value.length<=1}function k(t,e,n){e=D(e);for(var r=t.isNegative(),o=e.isNegative(),i=r?t.not():t,a=o?e.not():e,s=0,u=0,l=null,c=null,p=[];!i.isZero()||!a.isZero();)s=(l=M(i,A))[1].toJSNumber(),r&&(s=A-1-s),u=(c=M(a,A))[1].toJSNumber(),o&&(u=A-1-u),i=l[0],a=c[0],p.push(n(s,u));for(var h=0!==n(r?1:0,o?1:0)?bigInt(-1):bigInt(0),d=p.length-1;d>=0;d-=1)h=h.multiply(A).add(bigInt(p[d]));return h}s.prototype.shiftLeft=function(t){if(!N(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftRight(-t);for(var e=this;t>=C;)e=e.multiply(A),t-=C-1;return e.multiply(L[t])},u.prototype.shiftLeft=s.prototype.shiftLeft,s.prototype.shiftRight=function(t){var e;if(!N(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftLeft(-t);for(var n=this;t>=C;){if(n.isZero())return n;n=(e=M(n,A))[1].isNegative()?e[0].prev():e[0],t-=C-1}return(e=M(n,L[t]))[1].isNegative()?e[0].prev():e[0]},u.prototype.shiftRight=s.prototype.shiftRight,s.prototype.not=function(){return this.negate().prev()},u.prototype.not=s.prototype.not,s.prototype.and=function(t){return k(this,t,function(t,e){return t&e})},u.prototype.and=s.prototype.and,s.prototype.or=function(t){return k(this,t,function(t,e){return t|e})},u.prototype.or=s.prototype.or,s.prototype.xor=function(t){return k(this,t,function(t,e){return t^e})},u.prototype.xor=s.prototype.xor;var j=1<<30,B=(e&-e)*(e&-e)|j;function O(t){var n=t.value,r="number"==typeof n?n|j:n[0]+n[1]*e|B;return r&-r}function P(t,e){return t=D(t),e=D(e),t.greater(e)?t:e}function H(t,e){return t=D(t),e=D(e),t.lesser(e)?t:e}function R(t,e){if(t=D(t).abs(),e=D(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var n,r,o=a[1];t.isEven()&&e.isEven();)n=Math.min(O(t),O(e)),t=t.divide(n),e=e.divide(n),o=o.multiply(n);for(;t.isEven();)t=t.divide(O(t));do{for(;e.isEven();)e=e.divide(O(e));t.greater(e)&&(r=e,e=t,t=r),e=e.subtract(t)}while(!e.isZero());return o.isUnit()?t:t.multiply(o)}var Z=function(t,e){for(var n=t.length,r=Math.abs(e),o=0;o<n;o++){if("-"!==(c=t[o].toLowerCase())&&/[a-z0-9]/.test(c)){if(/[0-9]/.test(c)&&+c>=r){if("1"===c&&1===r)continue;throw new Error(c+" is not a valid digit in base "+e+".")}if(c.charCodeAt(0)-87>=r)throw new Error(c+" is not a valid digit in base "+e+".")}}if(2<=e&&e<=36&&n<=i/Math.log(e)){var a=parseInt(t,e);if(isNaN(a))throw new Error(c+" is not a valid digit in base "+e+".");return new u(parseInt(t,e))}e=D(e);var s=[],l="-"===t[0];for(o=l?1:0;o<t.length;o++){var c,p=(c=t[o].toLowerCase()).charCodeAt(0);if(48<=p&&p<=57)s.push(D(c));else if(97<=p&&p<=122)s.push(D(c.charCodeAt(0)-87));else{if("<"!==c)throw new Error(c+" is not a valid character");var h=o;do{o++}while(">"!==t[o]);s.push(D(t.slice(h+1,o)))}}return z(s,e,l)};function z(t,e,n){var r,o=a[0],i=a[1];for(r=t.length-1;r>=0;r--)o=o.add(t[r].times(i)),i=i.times(e);return n?o.negate():o}function U(t){var e=t.value;return"number"==typeof e&&(e=[e]),1===e.length&&e[0]<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e[0]):"<"+e+">"}function J(t,e){if((e=bigInt(e)).isZero()){if(t.isZero())return"0";throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1))return t.isZero()?"0":t.isNegative()?new Array(1-t).join("10"):"1"+new Array(+t).join("01");var n="";if(t.isNegative()&&e.isPositive()&&(n="-",t=t.abs()),e.equals(1))return t.isZero()?"0":n+new Array(+t+1).join(1);for(var r,o=[],i=t;i.isNegative()||i.compareAbs(e)>=0;){r=i.divmod(e),i=r.quotient;var a=r.remainder;a.isNegative()&&(a=e.minus(a).abs(),i=i.next()),o.push(U(a))}return o.push(U(i)),n+o.reverse().join("")}function $(t){if(l(+t)){var e=+t;if(e===f(e))return new u(e);throw"Invalid integer: "+t}var r="-"===t[0];r&&(t=t.slice(1));var o=t.split(/e/i);if(o.length>2)throw new Error("Invalid integer: "+o.join("e"));if(2===o.length){var i=o[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==f(i)||!l(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var a=o[0],c=a.indexOf(".");if(c>=0&&(i-=a.length-c-1,a=a.slice(0,c)+a.slice(c+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=a+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);for(var p=[],d=t.length,v=n,g=d-v;d>0;)p.push(+t.slice(g,d)),(g-=v)<0&&(g=0),d-=v;return h(p),new s(p,r)}function D(t){return"number"==typeof t?function(t){if(l(t)){if(t!==f(t))throw new Error(t+" is not an integer.");return new u(t)}return $(t.toString())}(t):"string"==typeof t?$(t):t}s.prototype.toString=function(t){if(void 0===t&&(t=10),10!==t)return J(this,t);for(var e,n=this.value,r=n.length,o=String(n[--r]);--r>=0;)e=String(n[r]),o+="0000000".slice(e.length)+e;return(this.sign?"-":"")+o},u.prototype.toString=function(t){return void 0===t&&(t=10),10!=t?J(this,t):String(this.value)},s.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},s.prototype.valueOf=function(){return+this.toString()},s.prototype.toJSNumber=s.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf;for(var Q=0;Q<1e3;Q++)a[Q]=new u(Q),Q>0&&(a[-Q]=new u(-Q));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=P,a.min=H,a.gcd=R,a.lcm=function(t,e){return t=D(t).abs(),e=D(e).abs(),t.divide(R(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof s||t instanceof u},a.randBetween=function(t,n){var r=H(t=D(t),n=D(n)),o=P(t,n).subtract(r).add(1);if(o.isSmall)return r.add(Math.floor(Math.random()*o));for(var i=[],a=!0,l=o.value.length-1;l>=0;l--){var c=a?o.value[l]:e,h=f(Math.random()*c);i.unshift(h),h<c&&(a=!1)}return i=p(i),r.add("number"==typeof i?new u(i):new s(i,!1))},a.fromArray=function(t,e,n){return z(t.map(D),D(e||10),n)},a}();"undefined"!=typeof module&&module.hasOwnProperty("exports")&&(module.exports=bigInt),"function"==typeof define&&define.amd&&define("big-integer",[],function(){return bigInt}),function(t){function e(t,e){var n=typeof t[e];return"function"===n||!("object"!=n||!t[e])||"unknown"==n}function n(t,e){return typeof t[e]!=g}function r(t,e){return!("object"!=typeof t[e]||!t[e])}function o(t,e,n){return 0>e&&(e+=t.value.length),typeof n==g&&(n=e),0>n&&(n+=t.value.length),{start:e,end:n}}function i(t,e,n){return{start:e,end:n,length:n-e,text:t.value.slice(e,n)}}function a(){return r(document,"body")?document.body:document.getElementsByTagName("body")[0]}var s,u,l,c,p,h,d,f,v,g="undefined";t(document).ready(function(){function y(t,e){var n=t.value,r=s(t),o=r.start;return{value:n.slice(0,o)+e+n.slice(r.end),index:o,replaced:r.text}}function m(t,e){t.focus();var n=s(t);return u(t,n.start,n.end),""==e?document.execCommand("delete",!1,null):document.execCommand("insertText",!1,e),{replaced:n.text,index:n.start}}function b(t,e){t.focus();var n=y(t,e);return t.value=n.value,n}function w(t,e){return function(){var n=this.jquery?this[0]:this,r=n.nodeName.toLowerCase();if(1==n.nodeType&&("textarea"==r||"input"==r&&/^(?:text|email|number|search|tel|url|password)$/i.test(n.type))){var o=[n].concat(Array.prototype.slice.call(arguments)),i=t.apply(this,o);if(!e)return i}return e?this:void 0}}var S=document.createElement("textarea");if(a().appendChild(S),n(S,"selectionStart")&&n(S,"selectionEnd"))s=function(t){return i(t,t.selectionStart,t.selectionEnd)},u=function(t,e,n){var r=o(t,e,n);t.selectionStart=r.start,t.selectionEnd=r.end},v=function(t,e){e?t.selectionEnd=t.selectionStart:t.selectionStart=t.selectionEnd};else{if(!(e(S,"createTextRange")&&r(document,"selection")&&e(document.selection,"createRange")))return a().removeChild(S),void function(t){window.console&&window.console.log&&window.console.log("RangyInputs not supported in your browser. Reason: "+t)}("No means of finding text input caret position");s=function(t){var e,n,r,o,a=0,s=0,u=document.selection.createRange();return u&&u.parentElement()==t&&(r=t.value.length,e=t.value.replace(/\r\n/g,"\n"),(n=t.createTextRange()).moveToBookmark(u.getBookmark()),(o=t.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",o)>-1?a=s=r:(a=-n.moveStart("character",-r),a+=e.slice(0,a).split("\n").length-1,n.compareEndPoints("EndToEnd",o)>-1?s=r:(s=-n.moveEnd("character",-r),s+=e.slice(0,s).split("\n").length-1))),i(t,a,s)};var x=function(t,e){return e-(t.value.slice(0,e).split("\r\n").length-1)};u=function(t,e,n){var r=o(t,e,n),i=t.createTextRange(),a=x(t,r.start);i.collapse(!0),r.start==r.end?i.move("character",a):(i.moveEnd("character",x(t,r.end)),i.moveStart("character",a)),i.select()},v=function(t,e){var n=document.selection.createRange();n.collapse(e),n.select()}}a().removeChild(S);var _=function(t,e){var n=y(t,e);try{var r=m(t,e);if(t.value==n.value)return _=m,r}catch(t){}return _=b,t.value=n.value,n};c=function(t,e,n,r){e!=n&&(u(t,e,n),_(t,"")),r&&u(t,e)},l=function(t){u(t,_(t,"").index)},f=function(t){var e=_(t,"");return u(t,e.index),e.replaced};var q=function(t,e,n,r){var o=e+n.length;if(("collapsetoend"==(r="string"==typeof r?r.toLowerCase():"")||"select"==r)&&/[\r\n]/.test(n)){var i=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n");o=e+i.length;var a=e+i.indexOf("\n");"\r\n"==t.value.slice(a,a+2)&&(o+=i.match(/\n/g).length)}switch(r){case"collapsetostart":u(t,e,e);break;case"collapsetoend":u(t,o,o);break;case"select":u(t,e,o)}};p=function(t,e,n,r){u(t,n),_(t,e),"boolean"==typeof r&&(r=r?"collapseToEnd":""),q(t,n,e,r)},h=function(t,e,n){var r=_(t,e);q(t,r.index,e,n||"collapseToEnd")},d=function(t,e,n,r){typeof n==g&&(n=e);var o=s(t),i=_(t,e+o.text+n);q(t,i.index+e.length,o.text,r||"select")},t.fn.extend({getSelection:w(s,!1),setSelection:w(u,!0),collapseSelection:w(v,!0),deleteSelectedText:w(l,!0),deleteText:w(c,!0),extractSelectedText:w(f,!1),insertText:w(p,!0),replaceSelectedText:w(h,!0),surroundSelectedText:w(d,!0)})})}(jQuery),function(t){function e(t){return t.clone().css({position:"absolute"})}function n(t){return t.split(/\s+/)}function r(e,n){return t(e="<div>"+e).find('*:not(:has("*"))').html(n).parentsUntil().slice(-1).html()}t.fn.splitLines=function(o){var i={width:"auto",tag:"<div>",wrap:"",keepHtml:!0};o&&t.extend(i,o);var a=e(this),s=this.contents(),u=this.text();this.append(a),a.text("42");var l=a.height()+2;a.empty();var c=e(a);"auto"!==i.width&&c.width(i.width),this.append(c);for(var p,h=i.keepHtml?function e(r){for(var o,i=[],a=0;a<r.length;a++)if("BR"!==r[a].nodeName){if(3==r[a].nodeType)o=n(r[a].textContent||r[a].toString());else{var s=t(r[a]).clone();o=e(s.contents());for(var u=0;u<o.length;u++)s.empty(),o[u]=s.html(o[u]).wrap("<p></p>").parent().html()}for(var l=0;l<o.length;l++)""!==o[l]&&i.push(o[l])}else i.push("<br>");return i}(s):n(u),d=0;d<h.length;d++){var f=c.html();c.html(f+h[d]+" "),c.html()!=p?c.height()>l&&(p=c.html(),c.html(f),a.append(r(i.tag,c.html())),c.html(""),d--):(p="",a.append(r(i.tag,c.html())),c.html(""))}a.append(r(i.tag,c.html())),this.html(a.html())}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){class e{constructor({id:t}){this.el=document.getElementById(t),this.cache="",this.el&&(this.mode=this.el.dataset.mode,this._initEvents(),this._renderLayout(this.el.innerHTML),"readonly"===this.mode?this.convert():this.el.dataset.postId&&this.invert())}_initEvents(){this.el.addEventListener("click",this._onClick.bind(this)),document.body.addEventListener("click",this._onClickGlobal.bind(this))}_onClick(t){const e=t.target.dataset.action&&t.target||t.target.closest("[data-action]"),n=e?e.dataset.action:null;n&&void 0!==this[n]&&this[n].call(this,t,e)}_onClickGlobal(t){const e=t.target.dataset.stcAction&&t.target||t.target.closest("[data-stc-action]"),n=e?e.dataset.stcAction:null;n&&void 0!==this[n]&&this[n].call(this,t,e)}_renderLayout(t=""){this.el.classList.add("stc"),this.el.innerHTML=`\n        <div class="stc--box">\n          <div class="stc--area stc--area__input">\n            <div class="stc--element">\n              \n              <div class="stc--panel stc--panel__image" hidden>\n                <button \n                  class="button button_secondary button_icon" \n                  data-action="addIsActiveClass" \n                  data-stc="alignleft">\n                    <i class="fas fa-align-left"></i>\n                </button>\n                \n                <button \n                  class="button button_secondary button_icon" \n                  data-action="addIsActiveClass" \n                  data-stc="aligncenter">\n                    <i class="fas fa-align-center"></i>\n                </button>\n                \n                <button \n                  class="button button_secondary button_icon" \n                  data-action="addIsActiveClass" \n                  data-stc="alignright">\n                    <i class="fas fa-align-right"></i>\n                </button>\n              </div>\n            </div>\n\n            <div class="stc--element">\n              <textarea\n                  placeholder="Type or copy/paste in your text here and click the Convert button…"\n                  name="stc"\n                  id="stc"\n                  cols="30"\n                  rows="10"\n                  class="stc--element__textarea">${t}</textarea>\n            </div>\n          </div>\n        </div>\n      `}convert(t,n){n&&(n.dataset.stcAction="backToTextarea",n.innerText="Back to Editor"),e.toggleSaveButton(),this._convertTextarea()}invert(){this.convert(null,document.querySelector('[data-stc-action="convert"]'))}static toggleSaveButton(){const t=document.querySelector(".header");t&&(t.querySelector(".header--save-panel").classList.toggle("hidden"),t.classList.toggle("is-save-panel"))}save(e){var n=e.target,r=document.querySelector('[name="post_title"]').value,o=document.querySelector('[name="post_public"]').checked,i={action:"save_sta_document",document:this.cache,post_title:r,post_status:o?"publish":"private",post_id:this.el.dataset.postId||!1};t.ajax({method:"post",url:window.sta.ajax,data:i,beforeSend:function(){n.setAttribute("disabled","disabled")},complete:function(t){var e=JSON.parse(t.responseText);e.error?alert(e.error):e.redirect&&(window.location.href=e.redirect),n.removeAttribute("disabled")}})}backToTextarea(t,n){n.dataset.stcAction="convert",n.innerText="Convert",e.toggleSaveButton(),this._renderLayout(this.cache)}showOutputTab(t,e){this.el.querySelector(".stc--element__output--text").hidden=!1,this.el.querySelector(".stc--element__output--code").hidden=!0,this.addIsActiveClass(t,e)}showCodeTab(t,e){this.el.querySelector(".stc--element__output--code").hidden=!1,this.el.querySelector(".stc--element__output--text").hidden=!0,this.addIsActiveClass(t,e)}_convertTextarea(){const e=this.el.querySelector(".stc--box"),n=this.el.querySelector(".stc--element__textarea"),r=this.handleHTML(n.value);this.cache=n.value;e.innerHTML=`\n        <div class="stc--area stc--area__output">\n          <div class="stc--element stc--element__output stc--element__output--text"> \n            ${r}\n          </div>\n\n          <div class="stc--element stc--element__output stc--element__output--code" hidden>\n            <textarea\n                name="stc-html-output"\n                id="stc"\n                cols="30"\n                rows="10"\n                class="stc--element__textarea"\n                readonly></textarea>\n          </div>\n        </div>\n      `;const o=t(".stc--element__output--text");o.find("p, h1, h2, h3, h4, h5, h6").each(function(){t(this).splitLines({tag:'<span class="switcher-line">',keepHtml:!0,width:o.width()})}),o.find("p").each(function(){t(this).find(".switcher-line").each(function(e){[].forEach.call(this.childNodes,e=>{" "===e.textContent&&null!==e.previousElementSibling&&"BR"===e.previousElementSibling.nodeName&&null===e.previousElementSibling.previousSibling&&t(e.parentNode).replaceWith(t("<br>"))})})}),t('[name="stc-html-output"]').html(o[0].innerHTML)}wrapSelectedByBold(){const e=this.el.querySelector(".stc--element__textarea");t(e).surroundSelectedText("[bold]","[/bold]")}wrapSelectedByP(){const e=this.el.querySelector(".stc--element__textarea");t(e).surroundSelectedText("<p>","</p>")}getSelection(){const e=this.el.querySelector(".stc--element__textarea");return t(e).getSelection()}insertImage(){const e=this.el.querySelector(".stc--element__textarea"),n=this.el.querySelector(".stc--panel__textarea"),r=this.el.querySelector(".stc--panel__image"),o=e.parentElement,i=this.getSelection().start;this.showImageUrlInput({onInit:()=>{o.hidden=!0,n.hidden=!0,r.hidden=!1,o.insertAdjacentHTML("afterEnd",'\n            <div class="stc--element stc--element__input-url">\n              <input type="url" name="stc-url" class="stc--element__input" placeholder="https://www.path.to/image.jpg">\n              <div class="stc--element__buttons">\n                <button class="button button_primary button_icon"><i class="fas fa-check"></i></button>\n                <button class="button button_secondary button_icon"><i class="fas fa-times"></i></button>\n              </div>\n            </div>\n          ')},onInsert:(n,r)=>{t(e).insertText(`<img src="${n}" class="${r}" alt='' />`,i,"collapseToEnd")},onClose:()=>{o.hidden=!1,n.hidden=!1,r.hidden=!0,this.el.querySelector(".stc--element__input-url").remove()}})}showImageUrlInput({onInit:t,onInsert:e,onClose:n}){t();const r=this.el.querySelector(".stc--element__input-url");r&&r.addEventListener("click",function(t){const o=t.target.classList.contains("fas")?t.target:t.target.children[0];if(void 0!==o&&o.classList.contains("fas")){if(o.classList.contains("fa-check")){const t=r.querySelector('[name="stc-url"]').value,n=document.querySelector(".stc--panel__image"),o=n.querySelector(".is-active")?n.querySelector(".is-active").dataset.stc:"alignnone";o&&e(t,o)}n()}})}addIsActiveClass(t,e){[].forEach.call(e.parentNode.children,t=>t.classList.remove("is-active")),e.classList.add("is-active")}handleHTML(e){const n=t(`<div>${e}</div>`);return[].forEach.call(n[0].childNodes,function(e){"#text"===e.nodeName&&e.textContent.match(/[a-z]/i)&&t(e).wrap("<p></p>")}),n[0].innerHTML=n[0].innerHTML.replace(/\[bold\]/g,"<b>").replace(/\[\/bold\]/g,"</b>"),n.find("p, h1, h2, h3, h4, h5, h6, b").each(function(){this.innerHTML=this.innerHTML.replace(/\r?\n/g,"<br/>")}),n[0].innerHTML=n[0].innerHTML.replace(/<p><br>/g,"<p>"),n[0].innerHTML=n[0].innerHTML.replace(/<br><\/p>/g,"</p>"),n[0].innerHTML}}window.SimpleTextConverter=e}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){new(0,window.SimpleTextConverter)({id:"stc"}),t("body").attr("data-form-style","none")});